{"id": 3642, "fid": "3642", "name": "查找有两极分化观点的书籍", "slug": "find-books-with-polarized-opinions", "link": "https://leetcode.cn/problems/find-books-with-polarized-opinions/description/", "percent": 0, "level": "Easy", "category": "algorithms", "en_name": "Find Books with Polarized Opinions", "cn_name": "查找有两极分化观点的书籍", "desc": "<p>表：<code>books</code></p>\n\n<pre>\n+-------------+---------+\n| Column Name | Type    |\n+-------------+---------+\n| book_id     | int     |\n| title       | varchar |\n| author      | varchar |\n| genre       | varchar |\n| pages       | int     |\n+-------------+---------+\nbook_id 是这张表的唯一主键。\n每一行包含关于一本书的信息，包括其类型和页数。\n</pre>\n\n<p>表：<code>reading_sessions</code></p>\n\n<pre>\n+----------------+---------+\n| Column Name    | Type    |\n+----------------+---------+\n| session_id     | int     |\n| book_id        | int     |\n| reader_name    | varchar |\n| pages_read     | int     |\n| session_rating | int     |\n+----------------+---------+\nsession_id 是这张表的唯一主键。\n每一行代表一次阅读事件，有人阅读了书籍的一部分。session_rating 在 1-5 的范围内。\n</pre>\n\n<p>编写一个解决方案来找到具有 <strong>两极分化观点</strong> 的书 - 同时获得不同读者极高和极低评分的书籍。</p>\n\n<ul>\n\t<li>如果一本书有至少一个大于等于&nbsp;<code>4</code>&nbsp;的评分和至少一个小于等于&nbsp;<code>2</code>&nbsp;的评分则是有两极分化观点的书</li>\n\t<li>只考虑有至少 <code>5</code> 次阅读事件的书籍</li>\n\t<li>按&nbsp;<code>highest_rating - lowest_rating</code>&nbsp;计算评分差幅&nbsp;<strong>rating spread</strong></li>\n\t<li>按极端评分（评分小于等于 <code>2</code> 或大于等于 <code>4</code>）的数量除以总阅读事件计算 <strong>极化得分&nbsp;polarization score</strong></li>\n\t<li><strong>只包含</strong>&nbsp;极化得分大于等于&nbsp;<code>0.6</code>&nbsp;的书（至少&nbsp;<code>60%</code>&nbsp;极端评分）</li>\n</ul>\n\n<p>返回结果表按极化得分 <strong>降序</strong> 排序，然后按标题 <strong>降序</strong> 排序。</p>\n\n<p>返回格式如下所示。</p>\n\n<p>&nbsp;</p>\n\n<p><strong class=\"example\">示例：</strong></p>\n\n<div class=\"example-block\">\n<p><strong>输入：</strong></p>\n\n<p>books 表：</p>\n\n<pre class=\"example-io\">\n+---------+------------------------+---------------+----------+-------+\n| book_id | title                  | author        | genre    | pages |\n+---------+------------------------+---------------+----------+-------+\n| 1       | The Great Gatsby       | F. Scott      | Fiction  | 180   |\n| 2       | To Kill a Mockingbird  | Harper Lee    | Fiction  | 281   |\n| 3       | 1984                   | George Orwell | Dystopian| 328   |\n| 4       | Pride and Prejudice    | Jane Austen   | Romance  | 432   |\n| 5       | The Catcher in the Rye | J.D. Salinger | Fiction  | 277   |\n+---------+------------------------+---------------+----------+-------+\n</pre>\n\n<p>reading_sessions 表：</p>\n\n<pre class=\"example-io\">\n+------------+---------+-------------+------------+----------------+\n| session_id | book_id | reader_name | pages_read | session_rating |\n+------------+---------+-------------+------------+----------------+\n| 1          | 1       | Alice       | 50         | 5              |\n| 2          | 1       | Bob         | 60         | 1              |\n| 3          | 1       | Carol       | 40         | 4              |\n| 4          | 1       | David       | 30         | 2              |\n| 5          | 1       | Emma        | 45         | 5              |\n| 6          | 2       | Frank       | 80         | 4              |\n| 7          | 2       | Grace       | 70         | 4              |\n| 8          | 2       | Henry       | 90         | 5              |\n| 9          | 2       | Ivy         | 60         | 4              |\n| 10         | 2       | Jack        | 75         | 4              |\n| 11         | 3       | Kate        | 100        | 2              |\n| 12         | 3       | Liam        | 120        | 1              |\n| 13         | 3       | Mia         | 80         | 2              |\n| 14         | 3       | Noah        | 90         | 1              |\n| 15         | 3       | Olivia      | 110        | 4              |\n| 16         | 3       | Paul        | 95         | 5              |\n| 17         | 4       | Quinn       | 150        | 3              |\n| 18         | 4       | Ruby        | 140        | 3              |\n| 19         | 5       | Sam         | 80         | 1              |\n| 20         | 5       | Tara        | 70         | 2              |\n+------------+---------+-------------+------------+----------------+\n</pre>\n\n<p><strong>输出：</strong></p>\n\n<pre class=\"example-io\">\n+---------+------------------+---------------+-----------+-------+---------------+--------------------+\n| book_id | title            | author        | genre     | pages | rating_spread | polarization_score |\n+---------+------------------+---------------+-----------+-------+---------------+--------------------+\n| 1       | The Great Gatsby | F. Scott      | Fiction   | 180   | 4             | 1.00               |\n| 3       | 1984             | George Orwell | Dystopian | 328   | 4             | 1.00               |\n+---------+------------------+---------------+-----------+-------+---------------+--------------------+\n</pre>\n\n<p><strong>解释：</strong></p>\n\n<ul>\n\t<li><strong>了不起的盖茨比（book_id = 1）：</strong>\n\n\t<ul>\n\t\t<li>有 5 次阅读事件（满足最少要求）</li>\n\t\t<li>评分：5, 1, 4, 2, 5</li>\n\t\t<li>大于等于 4 的评分：5，4，5（3 次事件）</li>\n\t\t<li>小于等于 2 的评分：1，2（2 次事件）</li>\n\t\t<li>评分差：5 - 1 = 4</li>\n\t\t<li>极端评分（≤2 或&nbsp;≥4）：所有 5 次事件（5，1，4，2，5）</li>\n\t\t<li>极化得分：5/5 = 1.00（≥&nbsp;0.6，符合）</li>\n\t</ul>\n\t</li>\n\t<li><strong>1984 (book_id = 3):</strong>\n\t<ul>\n\t\t<li>有 6&nbsp;次阅读事件（满足最少要求）</li>\n\t\t<li>评分：2，1，2，1，4，5</li>\n\t\t<li>大于等于 4 的评分：4，5（2 次事件）</li>\n\t\t<li>小于等于 2 的评分：2，1，2，1（4&nbsp;次事件）</li>\n\t\t<li>评分差：5 - 1 = 4</li>\n\t\t<li>极端评分（≤2 或&nbsp;≥4）：所有 6&nbsp;次事件（2，1，2，1，4，5）</li>\n\t\t<li>极化得分：6/6 = 1.00 (≥ 0.6，符合）</li>\n\t</ul>\n\t</li>\n\t<li><strong>未包含的书：</strong>\n\t<ul>\n\t\t<li>杀死一只知更鸟（book_id = 2）：所有评分为 4-5，没有低分（≤2）</li>\n\t\t<li>傲慢与偏见（book_id = 4）：只有&nbsp;2 次事件（&lt; 最少 5 次）</li>\n\t\t<li>麦田里的守望者（book_id = 5）：只有&nbsp;2 次事件（&lt; 最少 5 次）</li>\n\t</ul>\n\t</li>\n</ul>\n\n<p>结果表按极化得分降序排序，然后按标题降序排序。</p>\n</div>\n", "templates": [{"value": "mysql", "text": "MySQL", "defaultCode": "# Write your MySQL query statement below"}, {"value": "mssql", "text": "MS SQL Server", "defaultCode": "/* Write your T-SQL query statement below */"}, {"value": "oraclesql", "text": "Oracle", "defaultCode": "/* Write your PL/SQL query statement below */"}, {"value": "pythondata", "text": "Pandas", "defaultCode": "import pandas as pd\n\ndef find_polarized_books(books: pd.DataFrame, reading_sessions: pd.DataFrame) -> pd.DataFrame:\n    "}, {"value": "postgresql", "text": "PostgreSQL", "defaultCode": "-- Write your PostgreSQL query statement below"}]}