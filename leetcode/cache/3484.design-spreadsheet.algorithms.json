{"id": 3484, "fid": "3484", "name": "设计电子表格", "slug": "design-spreadsheet", "link": "https://leetcode.cn/problems/design-spreadsheet/description/", "percent": 0, "level": "Medium", "category": "algorithms", "en_name": "Design Spreadsheet", "cn_name": "设计电子表格", "desc": "<p>电子表格是一个网格，它有 26 列（从 <code>'A'</code> 到 <code>'Z'</code>）和指定数量的 <code>rows</code>。每个单元格可以存储一个 0 到 10<sup>5</sup>&nbsp;之间的整数值。</p>\n\n<p>请你实现一个&nbsp;<code>Spreadsheet</code> 类：</p>\n\n<ul>\n\t<li><code>Spreadsheet(int rows)</code> 初始化一个具有 26 列（从 <code>'A'</code> 到 <code>'Z'</code>）和指定行数的电子表格。所有单元格最初的值都为 0 。</li>\n\t<li><code>void setCell(String cell, int value)</code> 设置指定单元格的值。单元格引用以 <code>\"AX\"</code> 的格式提供（例如，<code>\"A1\"</code>，<code>\"B10\"</code>），其中字母表示列（从 <code>'A'</code> 到 <code>'Z'</code>），数字表示从<strong>&nbsp;</strong><strong>1</strong>&nbsp;开始的行号。</li>\n\t<li><code>void resetCell(String cell)</code> 重置指定单元格的值为 0 。</li>\n\t<li><code>int getValue(String formula)</code> 计算一个公式的值，格式为 <code>\"=X+Y\"</code>，其中 <code>X</code> 和 <code>Y</code>&nbsp;<strong>要么</strong> 是单元格引用，要么非负整数，返回计算的和。</li>\n</ul>\n\n<p><strong>注意：</strong> 如果 <code>getValue</code> 引用一个未通过 <code>setCell</code> 明确设置的单元格，则该单元格的值默认为 0 。</p>\n\n<p>&nbsp;</p>\n\n<p><strong class=\"example\">示例 1：</strong></p>\n\n<div class=\"example-block\">\n<p><strong>输入：</strong><br />\n<span class=\"example-io\">[\"Spreadsheet\", \"getValue\", \"setCell\", \"getValue\", \"setCell\", \"getValue\", \"resetCell\", \"getValue\"]<br />\n[[3], [\"=5+7\"], [\"A1\", 10], [\"=A1+6\"], [\"B2\", 15], [\"=A1+B2\"], [\"A1\"], [\"=A1+B2\"]]</span></p>\n\n<p><strong>输出：</strong><br />\n<span class=\"example-io\">[null, 12, null, 16, null, 25, null, 15] </span></p>\n\n<p><strong>解释</strong></p>\nSpreadsheet spreadsheet = new Spreadsheet(3); // 初始化一个具有 3 行和 26 列的电子表格<br data-end=\"321\" data-start=\"318\" />\nspreadsheet.getValue(\"=5+7\"); // 返回 12 (5+7)<br data-end=\"373\" data-start=\"370\" />\nspreadsheet.setCell(\"A1\", 10); // 设置 A1 为 10<br data-end=\"423\" data-start=\"420\" />\nspreadsheet.getValue(\"=A1+6\"); // 返回 16 (10+6)<br data-end=\"477\" data-start=\"474\" />\nspreadsheet.setCell(\"B2\", 15); // 设置 B2 为 15<br data-end=\"527\" data-start=\"524\" />\nspreadsheet.getValue(\"=A1+B2\"); // 返回 25 (10+15)<br data-end=\"583\" data-start=\"580\" />\nspreadsheet.resetCell(\"A1\"); // 重置 A1 为 0<br data-end=\"634\" data-start=\"631\" />\nspreadsheet.getValue(\"=A1+B2\"); // 返回 15 (0+15)</div>\n\n<p>&nbsp;</p>\n\n<p><strong>提示：</strong></p>\n\n<ul>\n\t<li><code>1 &lt;= rows &lt;= 10<sup>3</sup></code></li>\n\t<li><code>0 &lt;= value &lt;= 10<sup>5</sup></code></li>\n\t<li>公式保证采用 <code>\"=X+Y\"</code> 格式，其中 <code>X</code> 和 <code>Y</code> 要么是有效的单元格引用，要么是小于等于 <code>10<sup>5</sup></code> 的 <strong>非负</strong> 整数。</li>\n\t<li>每个单元格引用由一个大写字母 <code>'A'</code> 到 <code>'Z'</code> 和一个介于 <code>1</code> 和 <code>rows</code> 之间的行号组成。</li>\n\t<li><strong>总共</strong> 最多会对 <code>setCell</code>、<code>resetCell</code> 和 <code>getValue</code> 调用 <code>10<sup>4</sup></code> 次。</li>\n</ul>\n", "templates": [{"value": "cpp", "text": "C++", "defaultCode": "class Spreadsheet {\npublic:\n    Spreadsheet(int rows) {\n        \n    }\n    \n    void setCell(string cell, int value) {\n        \n    }\n    \n    void resetCell(string cell) {\n        \n    }\n    \n    int getValue(string formula) {\n        \n    }\n};\n\n/**\n * Your Spreadsheet object will be instantiated and called as such:\n * Spreadsheet* obj = new Spreadsheet(rows);\n * obj->setCell(cell,value);\n * obj->resetCell(cell);\n * int param_3 = obj->getValue(formula);\n */"}, {"value": "java", "text": "Java", "defaultCode": "class Spreadsheet {\n\n    public Spreadsheet(int rows) {\n        \n    }\n    \n    public void setCell(String cell, int value) {\n        \n    }\n    \n    public void resetCell(String cell) {\n        \n    }\n    \n    public int getValue(String formula) {\n        \n    }\n}\n\n/**\n * Your Spreadsheet object will be instantiated and called as such:\n * Spreadsheet obj = new Spreadsheet(rows);\n * obj.setCell(cell,value);\n * obj.resetCell(cell);\n * int param_3 = obj.getValue(formula);\n */"}, {"value": "python", "text": "Python", "defaultCode": "class Spreadsheet(object):\n\n    def __init__(self, rows):\n        \"\"\"\n        :type rows: int\n        \"\"\"\n        \n\n    def setCell(self, cell, value):\n        \"\"\"\n        :type cell: str\n        :type value: int\n        :rtype: None\n        \"\"\"\n        \n\n    def resetCell(self, cell):\n        \"\"\"\n        :type cell: str\n        :rtype: None\n        \"\"\"\n        \n\n    def getValue(self, formula):\n        \"\"\"\n        :type formula: str\n        :rtype: int\n        \"\"\"\n        \n\n\n# Your Spreadsheet object will be instantiated and called as such:\n# obj = Spreadsheet(rows)\n# obj.setCell(cell,value)\n# obj.resetCell(cell)\n# param_3 = obj.getValue(formula)"}, {"value": "python3", "text": "Python3", "defaultCode": "class Spreadsheet:\n\n    def __init__(self, rows: int):\n        \n\n    def setCell(self, cell: str, value: int) -> None:\n        \n\n    def resetCell(self, cell: str) -> None:\n        \n\n    def getValue(self, formula: str) -> int:\n        \n\n\n# Your Spreadsheet object will be instantiated and called as such:\n# obj = Spreadsheet(rows)\n# obj.setCell(cell,value)\n# obj.resetCell(cell)\n# param_3 = obj.getValue(formula)"}, {"value": "c", "text": "C", "defaultCode": "\n\n\ntypedef struct {\n    \n} Spreadsheet;\n\n\nSpreadsheet* spreadsheetCreate(int rows) {\n    \n}\n\nvoid spreadsheetSetCell(Spreadsheet* obj, char* cell, int value) {\n    \n}\n\nvoid spreadsheetResetCell(Spreadsheet* obj, char* cell) {\n    \n}\n\nint spreadsheetGetValue(Spreadsheet* obj, char* formula) {\n    \n}\n\nvoid spreadsheetFree(Spreadsheet* obj) {\n    \n}\n\n/**\n * Your Spreadsheet struct will be instantiated and called as such:\n * Spreadsheet* obj = spreadsheetCreate(rows);\n * spreadsheetSetCell(obj, cell, value);\n \n * spreadsheetResetCell(obj, cell);\n \n * int param_3 = spreadsheetGetValue(obj, formula);\n \n * spreadsheetFree(obj);\n*/"}, {"value": "csharp", "text": "C#", "defaultCode": "public class Spreadsheet {\n\n    public Spreadsheet(int rows) {\n        \n    }\n    \n    public void SetCell(string cell, int value) {\n        \n    }\n    \n    public void ResetCell(string cell) {\n        \n    }\n    \n    public int GetValue(string formula) {\n        \n    }\n}\n\n/**\n * Your Spreadsheet object will be instantiated and called as such:\n * Spreadsheet obj = new Spreadsheet(rows);\n * obj.SetCell(cell,value);\n * obj.ResetCell(cell);\n * int param_3 = obj.GetValue(formula);\n */"}, {"value": "javascript", "text": "JavaScript", "defaultCode": "/**\n * @param {number} rows\n */\nvar Spreadsheet = function(rows) {\n    \n};\n\n/** \n * @param {string} cell \n * @param {number} value\n * @return {void}\n */\nSpreadsheet.prototype.setCell = function(cell, value) {\n    \n};\n\n/** \n * @param {string} cell\n * @return {void}\n */\nSpreadsheet.prototype.resetCell = function(cell) {\n    \n};\n\n/** \n * @param {string} formula\n * @return {number}\n */\nSpreadsheet.prototype.getValue = function(formula) {\n    \n};\n\n/** \n * Your Spreadsheet object will be instantiated and called as such:\n * var obj = new Spreadsheet(rows)\n * obj.setCell(cell,value)\n * obj.resetCell(cell)\n * var param_3 = obj.getValue(formula)\n */"}, {"value": "typescript", "text": "TypeScript", "defaultCode": "class Spreadsheet {\n    constructor(rows: number) {\n        \n    }\n\n    setCell(cell: string, value: number): void {\n        \n    }\n\n    resetCell(cell: string): void {\n        \n    }\n\n    getValue(formula: string): number {\n        \n    }\n}\n\n/**\n * Your Spreadsheet object will be instantiated and called as such:\n * var obj = new Spreadsheet(rows)\n * obj.setCell(cell,value)\n * obj.resetCell(cell)\n * var param_3 = obj.getValue(formula)\n */"}, {"value": "php", "text": "PHP", "defaultCode": "class Spreadsheet {\n    /**\n     * @param Integer $rows\n     */\n    function __construct($rows) {\n        \n    }\n  \n    /**\n     * @param String $cell\n     * @param Integer $value\n     * @return NULL\n     */\n    function setCell($cell, $value) {\n        \n    }\n  \n    /**\n     * @param String $cell\n     * @return NULL\n     */\n    function resetCell($cell) {\n        \n    }\n  \n    /**\n     * @param String $formula\n     * @return Integer\n     */\n    function getValue($formula) {\n        \n    }\n}\n\n/**\n * Your Spreadsheet object will be instantiated and called as such:\n * $obj = Spreadsheet($rows);\n * $obj->setCell($cell, $value);\n * $obj->resetCell($cell);\n * $ret_3 = $obj->getValue($formula);\n */"}, {"value": "swift", "text": "Swift", "defaultCode": "\nclass Spreadsheet {\n\n    init(_ rows: Int) {\n        \n    }\n    \n    func setCell(_ cell: String, _ value: Int) {\n        \n    }\n    \n    func resetCell(_ cell: String) {\n        \n    }\n    \n    func getValue(_ formula: String) -> Int {\n        \n    }\n}\n\n/**\n * Your Spreadsheet object will be instantiated and called as such:\n * let obj = Spreadsheet(rows)\n * obj.setCell(cell, value)\n * obj.resetCell(cell)\n * let ret_3: Int = obj.getValue(formula)\n */"}, {"value": "kotlin", "text": "Kotlin", "defaultCode": "class Spreadsheet(rows: Int) {\n\n    fun setCell(cell: String, value: Int) {\n        \n    }\n\n    fun resetCell(cell: String) {\n        \n    }\n\n    fun getValue(formula: String): Int {\n        \n    }\n\n}\n\n/**\n * Your Spreadsheet object will be instantiated and called as such:\n * var obj = Spreadsheet(rows)\n * obj.setCell(cell,value)\n * obj.resetCell(cell)\n * var param_3 = obj.getValue(formula)\n */"}, {"value": "dart", "text": "Dart", "defaultCode": "class Spreadsheet {\n\n  Spreadsheet(int rows) {\n    \n  }\n  \n  void setCell(String cell, int value) {\n    \n  }\n  \n  void resetCell(String cell) {\n    \n  }\n  \n  int getValue(String formula) {\n    \n  }\n}\n\n/**\n * Your Spreadsheet object will be instantiated and called as such:\n * Spreadsheet obj = Spreadsheet(rows);\n * obj.setCell(cell,value);\n * obj.resetCell(cell);\n * int param3 = obj.getValue(formula);\n */"}, {"value": "golang", "text": "Go", "defaultCode": "type Spreadsheet struct {\n    \n}\n\n\nfunc Constructor(rows int) Spreadsheet {\n    \n}\n\n\nfunc (this *Spreadsheet) SetCell(cell string, value int)  {\n    \n}\n\n\nfunc (this *Spreadsheet) ResetCell(cell string)  {\n    \n}\n\n\nfunc (this *Spreadsheet) GetValue(formula string) int {\n    \n}\n\n\n/**\n * Your Spreadsheet object will be instantiated and called as such:\n * obj := Constructor(rows);\n * obj.SetCell(cell,value);\n * obj.ResetCell(cell);\n * param_3 := obj.GetValue(formula);\n */"}, {"value": "ruby", "text": "Ruby", "defaultCode": "class Spreadsheet\n\n=begin\n    :type rows: Integer\n=end\n    def initialize(rows)\n        \n    end\n\n\n=begin\n    :type cell: String\n    :type value: Integer\n    :rtype: Void\n=end\n    def set_cell(cell, value)\n        \n    end\n\n\n=begin\n    :type cell: String\n    :rtype: Void\n=end\n    def reset_cell(cell)\n        \n    end\n\n\n=begin\n    :type formula: String\n    :rtype: Integer\n=end\n    def get_value(formula)\n        \n    end\n\n\nend\n\n# Your Spreadsheet object will be instantiated and called as such:\n# obj = Spreadsheet.new(rows)\n# obj.set_cell(cell, value)\n# obj.reset_cell(cell)\n# param_3 = obj.get_value(formula)"}, {"value": "scala", "text": "Scala", "defaultCode": "class Spreadsheet(_rows: Int) {\n\n    def setCell(cell: String, value: Int): Unit = {\n        \n    }\n\n    def resetCell(cell: String): Unit = {\n        \n    }\n\n    def getValue(formula: String): Int = {\n        \n    }\n\n}\n\n/**\n * Your Spreadsheet object will be instantiated and called as such:\n * val obj = new Spreadsheet(rows)\n * obj.setCell(cell,value)\n * obj.resetCell(cell)\n * val param_3 = obj.getValue(formula)\n */"}, {"value": "rust", "text": "Rust", "defaultCode": "struct Spreadsheet {\n\n}\n\n\n/** \n * `&self` means the method takes an immutable reference.\n * If you need a mutable reference, change it to `&mut self` instead.\n */\nimpl Spreadsheet {\n\n    fn new(rows: i32) -> Self {\n        \n    }\n    \n    fn set_cell(&self, cell: String, value: i32) {\n        \n    }\n    \n    fn reset_cell(&self, cell: String) {\n        \n    }\n    \n    fn get_value(&self, formula: String) -> i32 {\n        \n    }\n}\n\n/**\n * Your Spreadsheet object will be instantiated and called as such:\n * let obj = Spreadsheet::new(rows);\n * obj.set_cell(cell, value);\n * obj.reset_cell(cell);\n * let ret_3: i32 = obj.get_value(formula);\n */"}, {"value": "racket", "text": "Racket", "defaultCode": "(define spreadsheet%\n  (class object%\n    (super-new)\n    \n    ; rows : exact-integer?\n    (init-field\n      rows)\n    \n    ; set-cell : string? exact-integer? -> void?\n    (define/public (set-cell cell value)\n      )\n    ; reset-cell : string? -> void?\n    (define/public (reset-cell cell)\n      )\n    ; get-value : string? -> exact-integer?\n    (define/public (get-value formula)\n      )))\n\n;; Your spreadsheet% object will be instantiated and called as such:\n;; (define obj (new spreadsheet% [rows rows]))\n;; (send obj set-cell cell value)\n;; (send obj reset-cell cell)\n;; (define param_3 (send obj get-value formula))"}, {"value": "erlang", "text": "Erlang", "defaultCode": "-spec spreadsheet_init_(Rows :: integer()) -> any().\nspreadsheet_init_(Rows) ->\n  .\n\n-spec spreadsheet_set_cell(Cell :: unicode:unicode_binary(), Value :: integer()) -> any().\nspreadsheet_set_cell(Cell, Value) ->\n  .\n\n-spec spreadsheet_reset_cell(Cell :: unicode:unicode_binary()) -> any().\nspreadsheet_reset_cell(Cell) ->\n  .\n\n-spec spreadsheet_get_value(Formula :: unicode:unicode_binary()) -> integer().\nspreadsheet_get_value(Formula) ->\n  .\n\n\n%% Your functions will be called as such:\n%% spreadsheet_init_(Rows),\n%% spreadsheet_set_cell(Cell, Value),\n%% spreadsheet_reset_cell(Cell),\n%% Param_3 = spreadsheet_get_value(Formula),\n\n%% spreadsheet_init_ will be called before every test case, in which you can do some necessary initializations."}, {"value": "elixir", "text": "Elixir", "defaultCode": "defmodule Spreadsheet do\n  @spec init_(rows :: integer) :: any\n  def init_(rows) do\n    \n  end\n\n  @spec set_cell(cell :: String.t, value :: integer) :: any\n  def set_cell(cell, value) do\n    \n  end\n\n  @spec reset_cell(cell :: String.t) :: any\n  def reset_cell(cell) do\n    \n  end\n\n  @spec get_value(formula :: String.t) :: integer\n  def get_value(formula) do\n    \n  end\nend\n\n# Your functions will be called as such:\n# Spreadsheet.init_(rows)\n# Spreadsheet.set_cell(cell, value)\n# Spreadsheet.reset_cell(cell)\n# param_3 = Spreadsheet.get_value(formula)\n\n# Spreadsheet.init_ will be called before every test case, in which you can do some necessary initializations."}, {"value": "cangjie", "text": "Cangjie", "defaultCode": "class Spreadsheet {\n    init(rows: Int64) {\n\n    }\n    \n    func setCell(cell: String, value: Int64): Unit {\n\n    }\n    \n    func resetCell(cell: String): Unit {\n\n    }\n    \n    func getValue(formula: String): Int64 {\n\n    }\n}\n\n/**\n * Your Spreadsheet object will be instantiated and called as such:\n * let obj: Spreadsheet = Spreadsheet(rows)\n * obj.setCell(cell,value)\n * obj.resetCell(cell)\n * let param_3 = obj.getValue(formula)\n */"}]}