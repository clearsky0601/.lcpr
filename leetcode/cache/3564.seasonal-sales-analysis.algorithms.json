{"id": 3564, "fid": "3564", "name": "季节性销售分析", "slug": "seasonal-sales-analysis", "link": "https://leetcode.cn/problems/seasonal-sales-analysis/description/", "percent": 0, "level": "Medium", "category": "algorithms", "en_name": "Seasonal Sales Analysis", "cn_name": "季节性销售分析", "desc": "<p>表：<code>sales</code></p>\n\n<pre>\n+---------------+---------+\n| Column Name   | Type    |\n+---------------+---------+\n| sale_id       | int     |\n| product_id    | int     |\n| sale_date     | date    |\n| quantity      | int     |\n| price         | decimal |\n+---------------+---------+\nsale_id 是这张表的唯一主键。\n每一行包含一件产品的销售信息，包括 product_id，销售日期，销售数量，以及单价。\n</pre>\n\n<p>表：<code>products</code></p>\n\n<pre>\n+---------------+---------+\n| Column Name   | Type    |\n+---------------+---------+\n| product_id    | int     |\n| product_name  | varchar |\n| category      | varchar |\n+---------------+---------+\nproduct_id 是这张表的唯一主键。\n每一行包含一件产品的信息，包括它的名字和分类。\n</pre>\n\n<p>编写一个解决方案来找到每个季节最受欢迎的产品分类。季节定义如下：</p>\n\n<ul>\n\t<li><strong>冬季</strong>：十二月，一月，二月</li>\n\t<li><strong>春季</strong>：三月，四月，五月</li>\n\t<li><strong>夏季</strong>：六月，七月，八月</li>\n\t<li><strong>秋季</strong>：九月，十月，十一月</li>\n</ul>\n\n<p>一个 <strong>分类</strong>&nbsp;的 <b>受欢迎度</b>&nbsp;由某个 <strong>季节</strong>&nbsp;的 <strong>总销售量</strong>&nbsp;决定。如果有并列，选择总收入最高的类别 (<code>quantity × price</code>)。</p>\n\n<p>返回结果表以季节 <strong>升序</strong>&nbsp;排序。</p>\n\n<p>结果格式如下所示。</p>\n\n<p>&nbsp;</p>\n\n<p><strong class=\"example\">示例：</strong></p>\n\n<div class=\"example-block\">\n<p><strong>输入：</strong></p>\n\n<p>sales 表：</p>\n\n<pre class=\"example-io\">\n+---------+------------+------------+----------+-------+\n| sale_id | product_id | sale_date  | quantity | price |\n+---------+------------+------------+----------+-------+\n| 1       | 1          | 2023-01-15 | 5        | 10.00 |\n| 2       | 2          | 2023-01-20 | 4        | 15.00 |\n| 3       | 3          | 2023-03-10 | 3        | 18.00 |\n| 4       | 4          | 2023-04-05 | 1        | 20.00 |\n| 5       | 1          | 2023-05-20 | 2        | 10.00 |\n| 6       | 2          | 2023-06-12 | 4        | 15.00 |\n| 7       | 5          | 2023-06-15 | 5        | 12.00 |\n| 8       | 3          | 2023-07-24 | 2        | 18.00 |\n| 9       | 4          | 2023-08-01 | 5        | 20.00 |\n| 10      | 5          | 2023-09-03 | 3        | 12.00 |\n| 11      | 1          | 2023-09-25 | 6        | 10.00 |\n| 12      | 2          | 2023-11-10 | 4        | 15.00 |\n| 13      | 3          | 2023-12-05 | 6        | 18.00 |\n| 14      | 4          | 2023-12-22 | 3        | 20.00 |\n| 15      | 5          | 2024-02-14 | 2        | 12.00 |\n+---------+------------+------------+----------+-------+\n</pre>\n\n<p>products 表：</p>\n\n<pre class=\"example-io\">\n+------------+-----------------+----------+\n| product_id | product_name    | category |\n+------------+-----------------+----------+\n| 1          | Warm Jacket     | Apparel  |\n| 2          | Designer Jeans  | Apparel  |\n| 3          | Cutting Board   | Kitchen  |\n| 4          | Smart Speaker   | Tech     |\n| 5          | Yoga Mat        | Fitness  |\n+------------+-----------------+----------+\n</pre>\n\n<p><strong>输出：</strong></p>\n\n<pre class=\"example-io\">\n+---------+----------+----------------+---------------+\n| season  | category | total_quantity | total_revenue |\n+---------+----------+----------------+---------------+\n| Fall    | Apparel  | 10             | 120.00        |\n| Spring  | Kitchen  | 3              | 54.00         |\n| Summer  | Tech     | 5              | 100.00        |\n| Winter  | Apparel  | 9              | 110.00        |\n+---------+----------+----------------+---------------+\n</pre>\n\n<p><strong>解释：</strong></p>\n\n<ul>\n\t<li><strong>秋季（九月，十月，十一月）：</strong>\n\n\t<ul>\n\t\t<li>服装：售出 10 件商品（在 9 月有 6 件夹克，在 11 月 有 4 条牛仔裤），收入 $120.00（6×$10.00 + 4×$15.00）</li>\n\t\t<li>健身: 9 月售出&nbsp;3 张瑜伽垫，收入&nbsp;$36.00</li>\n\t\t<li>最受欢迎：服装总数量最多（10）</li>\n\t</ul>\n\t</li>\n\t<li><strong>春季（三月，四月，五月）：</strong>\n\t<ul>\n\t\t<li>厨房：5 月 售出 3 张菜板，收入 $54.00</li>\n\t\t<li>科技：4 月 售出 1 台智能音箱，收入&nbsp;$20.00</li>\n\t\t<li>服装: 五月售出 2 件保暖夹克，收入&nbsp;$20.00</li>\n\t\t<li>最受欢迎：厨房总数量最多（3）且收入最多（$54.00）</li>\n\t</ul>\n\t</li>\n\t<li><strong>夏季（六月，七月，八月</strong><strong>）：</strong>\n\t<ul>\n\t\t<li>服装：六月售出 4 件名牌牛仔裤，收入 $60.00</li>\n\t\t<li>健身：六月售出 5&nbsp;张瑜伽垫，收入&nbsp;$60.00</li>\n\t\t<li>厨房：七月售出 2&nbsp;张菜板，收入 $36.00</li>\n\t\t<li>科技：八月售出 5&nbsp;台智能音箱，收入&nbsp;$100.00</li>\n\t\t<li>最受欢迎：科技和健身都有 5 件商品，但科技收入更多（$100.00 vs $60.00）</li>\n\t</ul>\n\t</li>\n\t<li><strong>冬季（十二月，一月，二月</strong><strong>）：</strong>\n\t<ul>\n\t\t<li>服装：售出 9 件商品（一月有 5 件夹克和&nbsp;4 条牛仔裤），收入 $110.00</li>\n\t\t<li>厨房：十二月售出 6 张菜板，收入 $108.00</li>\n\t\t<li>科技：十二月售出 3 台智能音箱，收入 $60.00</li>\n\t\t<li>健身：二月售出 2 张瑜伽垫，收入 $24.00</li>\n\t\t<li>最受欢迎：服装总数量最多（9）且收入最多（$110.00）</li>\n\t</ul>\n\t</li>\n</ul>\n\n<p>结果表以季节升序排序。</p>\n</div>\n", "templates": [{"value": "mysql", "text": "MySQL", "defaultCode": "# Write your MySQL query statement below"}, {"value": "mssql", "text": "MS SQL Server", "defaultCode": "/* Write your T-SQL query statement below */"}, {"value": "oraclesql", "text": "Oracle", "defaultCode": "/* Write your PL/SQL query statement below */"}, {"value": "pythondata", "text": "Pandas", "defaultCode": "import pandas as pd\n\ndef seasonal_sales_analysis(products: pd.DataFrame, sales: pd.DataFrame) -> pd.DataFrame:\n    "}, {"value": "postgresql", "text": "PostgreSQL", "defaultCode": "-- Write your PostgreSQL query statement below"}]}