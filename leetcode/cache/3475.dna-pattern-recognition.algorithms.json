{"id": 3475, "fid": "3475", "name": "DNA 模式识别", "slug": "dna-pattern-recognition", "link": "https://leetcode.cn/problems/dna-pattern-recognition/description/", "percent": 0, "level": "Medium", "category": "algorithms", "en_name": "DNA Pattern Recognition ", "cn_name": "DNA 模式识别", "desc": "<p>表：<code>Samples</code></p>\n\n<pre>\n+----------------+---------+\n| Column Name    | Type    | \n+----------------+---------+\n| sample_id      | int     |\n| dna_sequence   | varchar |\n| species        | varchar |\n+----------------+---------+\nsample_id 是这张表的唯一主键。\n每一行包含一个 DNA 序列以一个字符（A，T，G，C）组成的字符串表示以及它所采集自的物种。\n</pre>\n\n<p>生物学家正在研究 DNA 序列中的基本模式。编写一个解决方案以识别具有以下模式的&nbsp;<code>sample_id</code>：</p>\n\n<ul>\n\t<li>以&nbsp;<strong>ATG</strong> <strong>开头</strong>&nbsp;的序列（一个常见的 <strong>起始密码子</strong>）</li>\n\t<li>以 <strong>TAA</strong>，<strong>TAG</strong>&nbsp;或&nbsp;<strong>TGA</strong>&nbsp;<strong>结尾</strong>&nbsp;的序列（终止密码子）</li>\n\t<li>包含基序 <strong>ATAT</strong> 的序列（一个简单重复模式）</li>\n\t<li>有 <strong>至少</strong>&nbsp;<code>3</code>&nbsp;<strong>个连续</strong>&nbsp;<strong>G</strong>&nbsp;的序列（如&nbsp;<strong>GGG</strong>&nbsp;或&nbsp;<strong>GGGG</strong>）</li>\n</ul>\n\n<p>返回结果表以&nbsp;sample_id <strong>升序</strong>&nbsp;排序<em>。</em></p>\n\n<p>结果格式如下所示。</p>\n\n<p>&nbsp;</p>\n\n<p><strong class=\"example\">示例：</strong></p>\n\n<div class=\"example-block\">\n<p><strong>输入：</strong></p>\n\n<p>Samples 表：</p>\n\n<pre class=\"example-io\">\n+-----------+------------------+-----------+\n| sample_id | dna_sequence     | species   |\n+-----------+------------------+-----------+\n| 1         | ATGCTAGCTAGCTAA  | Human     |\n| 2         | GGGTCAATCATC     | Human     |\n| 3         | ATATATCGTAGCTA   | Human     |\n| 4         | ATGGGGTCATCATAA  | Mouse     |\n| 5         | TCAGTCAGTCAG     | Mouse     |\n| 6         | ATATCGCGCTAG     | Zebrafish |\n| 7         | CGTATGCGTCGTA    | Zebrafish |\n+-----------+------------------+-----------+\n</pre>\n\n<p><strong>输出：</strong></p>\n\n<pre class=\"example-io\">\n+-----------+------------------+-------------+-------------+------------+------------+------------+\n| sample_id | dna_sequence     | species     | has_start   | has_stop   | has_atat   | has_ggg    |\n+-----------+------------------+-------------+-------------+------------+------------+------------+\n| 1         | ATGCTAGCTAGCTAA  | Human       | 1           | 1          | 0          | 0          |\n| 2         | GGGTCAATCATC     | Human       | 0           | 0          | 0          | 1          |\n| 3         | ATATATCGTAGCTA   | Human       | 0           | 0          | 1          | 0          |\n| 4         | ATGGGGTCATCATAA  | Mouse       | 1           | 1          | 0          | 1          |\n| 5         | TCAGTCAGTCAG     | Mouse       | 0           | 0          | 0          | 0          |\n| 6         | ATATCGCGCTAG     | Zebrafish   | 0           | 1          | 1          | 0          |\n| 7         | CGTATGCGTCGTA    | Zebrafish   | 0           | 0          | 0          | 0          |\n+-----------+------------------+-------------+-------------+------------+------------+------------+\n</pre>\n\n<p><strong>解释：</strong></p>\n\n<ul>\n\t<li>样本 1（ATGCTAGCTAGCTAA）：\n\t<ul>\n\t\t<li>以 ATG 开头（has_start = 1）</li>\n\t\t<li>以 TAA 结尾（has_stop = 1）</li>\n\t\t<li>不包含 ATAT（has_atat = 0）</li>\n\t\t<li>不包含至少 3 个连续 ‘G’（has_ggg = 0）</li>\n\t</ul>\n\t</li>\n\t<li>样本 2（GGGTCAATCATC）：\n\t<ul>\n\t\t<li>不以 ATG 开头（has_start = 0）</li>\n\t\t<li>不以 TAA，TAG 或 TGA 结尾（has_stop = 0）</li>\n\t\t<li>不包含 ATAT（has_atat = 0）</li>\n\t\t<li>包含 GGG（has_ggg = 1）</li>\n\t</ul>\n\t</li>\n\t<li>样本 3（ATATATCGTAGCTA）：\n\t<ul>\n\t\t<li>不以 ATG 开头（has_start = 0）</li>\n\t\t<li>不以 TAA，TAG 或 TGA 结尾（has_stop = 0）</li>\n\t\t<li>包含 ATAT（has_atat = 1）</li>\n\t\t<li>不包含至少 3 个连续 ‘G’（has_ggg = 0）</li>\n\t</ul>\n\t</li>\n\t<li>样本 4（ATGGGGTCATCATAA）：\n\t<ul>\n\t\t<li>以 ATG 开头（has_start = 1）</li>\n\t\t<li>以 TAA 结尾（has_stop = 1）</li>\n\t\t<li>不包含 ATAT（has_atat = 0）</li>\n\t\t<li>包含 GGGG（has_ggg = 1）</li>\n\t</ul>\n\t</li>\n\t<li>样本 5（TCAGTCAGTCAG）：\n\t<ul>\n\t\t<li>不匹配任何模式（所有字段 = 0）</li>\n\t</ul>\n\t</li>\n\t<li>样本 6（ATATCGCGCTAG）：\n\t<ul>\n\t\t<li>不以 ATG 开头（has_start = 0）</li>\n\t\t<li>以 TAG 结尾（has_stop = 1）</li>\n\t\t<li>包含 ATAT（has_atat = 1）</li>\n\t\t<li>不包含至少 3 个连续 ‘G’（has_ggg = 0）</li>\n\t</ul>\n\t</li>\n\t<li>样本 7（CGTATGCGTCGTA）：\n\t<ul>\n\t\t<li>不以 ATG 开头（has_start = 0）</li>\n\t\t<li>不以 TAA，TAG 或 TGA 结尾（has_stop = 0）</li>\n\t\t<li>不包含 ATAT（has_atat = 0）</li>\n\t\t<li>不包含至少 3 个连续 ‘G’（has_ggg = 0）</li>\n\t</ul>\n\t</li>\n</ul>\n\n<p><strong>注意：</strong></p>\n\n<ul>\n\t<li>结果以 sample_id 升序排序</li>\n\t<li>对于每个模式，1 表示该模式存在，0 表示不存在</li>\n</ul>\n</div>\n", "templates": [{"value": "mysql", "text": "MySQL", "defaultCode": "# Write your MySQL query statement below"}, {"value": "mssql", "text": "MS SQL Server", "defaultCode": "/* Write your T-SQL query statement below */"}, {"value": "oraclesql", "text": "Oracle", "defaultCode": "/* Write your PL/SQL query statement below */"}, {"value": "pythondata", "text": "Pandas", "defaultCode": "import pandas as pd\n\ndef analyze_dna_patterns(samples: pd.DataFrame) -> pd.DataFrame:\n    "}, {"value": "postgresql", "text": "PostgreSQL", "defaultCode": "-- Write your PostgreSQL query statement below"}]}