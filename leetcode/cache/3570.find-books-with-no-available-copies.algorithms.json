{"id": 3570, "fid": "3570", "name": "查找无可用副本的书籍", "slug": "find-books-with-no-available-copies", "link": "https://leetcode.cn/problems/find-books-with-no-available-copies/description/", "percent": 0, "level": "Easy", "category": "algorithms", "en_name": "Find Books with No Available Copies", "cn_name": "查找无可用副本的书籍", "desc": "<p>表：<code>library_books</code></p>\n\n<pre>\n+------------------+---------+\n| Column Name      | Type    |\n+------------------+---------+\n| book_id          | int     |\n| title            | varchar |\n| author           | varchar |\n| genre            | varchar |\n| publication_year | int     |\n| total_copies     | int     |\n+------------------+---------+\nbook_id 是这张表的唯一主键。\n每一行包含图书馆中一本书的信息，包括图书馆拥有的副本总数。\n</pre>\n\n<p>表：<code>borrowing_records</code></p>\n\n<pre>\n+---------------+---------+\n| Column Name   | Type    |\n+---------------+---------+\n| record_id     | int     |\n| book_id       | int     |\n| borrower_name | varchar |\n| borrow_date   | date    |\n| return_date   | date    |\n+---------------+---------+\nrecord_id 是这张表的唯一主键。\n每一行代表一笔借阅交易并且如果这本书目前被借出并且还没有被归还，return_date 为 NULL。\n</pre>\n\n<p>编写一个解决方案以找到 <strong>所有</strong> <strong>当前被借出（未归还）&nbsp;</strong>且图书馆中 <strong>无可用副本</strong> 的书籍。</p>\n\n<ul>\n\t<li>如果存在一条借阅记录，其&nbsp;<code>return_date</code>&nbsp;为 <strong>NULL</strong>，那么这本书被认为 <strong>当前是借出的</strong>。</li>\n</ul>\n\n<p>返回结果表按当前借阅者数量 <strong>降序</strong> 排列，然后按书名 <strong>升序</strong> 排列。</p>\n\n<p>结果格式如下所示。</p>\n\n<p>&nbsp;</p>\n\n<p><strong class=\"example\">示例：</strong></p>\n\n<div class=\"example-block\">\n<p><strong>输入：</strong></p>\n\n<p>library_books 表：</p>\n\n<pre class=\"example-io\">\n+---------+------------------------+------------------+----------+------------------+--------------+\n| book_id | title                  | author           | genre    | publication_year | total_copies |\n+---------+------------------------+------------------+----------+------------------+--------------+\n| 1       | The Great Gatsby       | F. Scott         | Fiction  | 1925             | 3            |\n| 2       | To Kill a Mockingbird  | Harper Lee       | Fiction  | 1960             | 3            |\n| 3       | 1984                   | George Orwell    | Dystopian| 1949             | 1            |\n| 4       | Pride and Prejudice    | Jane Austen      | Romance  | 1813             | 2            |\n| 5       | The Catcher in the Rye | J.D. Salinger    | Fiction  | 1951             | 1            |\n| 6       | Brave New World        | Aldous Huxley    | Dystopian| 1932             | 4            |\n+---------+------------------------+------------------+----------+------------------+--------------+\n</pre>\n\n<p>borrowing_records 表：</p>\n\n<pre class=\"example-io\">\n+-----------+---------+---------------+-------------+-------------+\n| record_id | book_id | borrower_name | borrow_date | return_date |\n+-----------+---------+---------------+-------------+-------------+\n| 1         | 1       | Alice Smith   | 2024-01-15  | NULL        |\n| 2         | 1       | Bob Johnson   | 2024-01-20  | NULL        |\n| 3         | 2       | Carol White   | 2024-01-10  | 2024-01-25  |\n| 4         | 3       | David Brown   | 2024-02-01  | NULL        |\n| 5         | 4       | Emma Wilson   | 2024-01-05  | NULL        |\n| 6         | 5       | Frank Davis   | 2024-01-18  | 2024-02-10  |\n| 7         | 1       | Grace Miller  | 2024-02-05  | NULL        |\n| 8         | 6       | Henry Taylor  | 2024-01-12  | NULL        |\n| 9         | 2       | Ivan Clark    | 2024-02-12  | NULL        |\n| 10        | 2       | Jane Adams    | 2024-02-15  | NULL        |\n+-----------+---------+---------------+-------------+-------------+\n</pre>\n\n<p><strong>输出：</strong></p>\n\n<pre class=\"example-io\">\n+---------+------------------+---------------+-----------+------------------+-------------------+\n| book_id | title            | author        | genre     | publication_year | current_borrowers |\n+---------+------------------+---------------+-----------+------------------+-------------------+\n| 1       | The Great Gatsby | F. Scott      | Fiction   | 1925             | 3                 | \n| 3       | 1984             | George Orwell | Dystopian | 1949             | 1                 |\n+---------+------------------+---------------+-----------+------------------+-------------------+\n</pre>\n\n<p><strong>解释：</strong></p>\n\n<ul>\n\t<li><strong>The Great Gatsby (book_id = 1)：</strong>\n\n\t<ul>\n\t\t<li>总副本数：3</li>\n\t\t<li>当前被 Alice Smith，Bob Johnson 和 Grace Miller 借阅（3 名借阅者）</li>\n\t\t<li>可用副本数：3 - 3 = 0</li>\n\t\t<li>因为 available_copies = 0，所以被包含</li>\n\t</ul>\n\t</li>\n\t<li><strong>1984 (book_id = 3):</strong>\n\t<ul>\n\t\t<li>总副本数：1</li>\n\t\t<li>当前被 David Brown 借阅（1 名借阅者）</li>\n\t\t<li>可用副本数：1 - 1 = 0</li>\n\t\t<li>因为 available_copies = 0，所以被包含</li>\n\t</ul>\n\t</li>\n\t<li><strong>未被包含的书：</strong>\n\t<ul>\n\t\t<li>To Kill a Mockingbird (book_id = 2)：总副本数 = 3，当前借阅者&nbsp;= 2，可用副本 = 1</li>\n\t\t<li>Pride and Prejudice (book_id = 4)：总副本数 = 2，当前借阅者 = 1，可用副本 = 1</li>\n\t\t<li>The Catcher in the Rye (book_id = 5)：总副本数 = 1，当前借阅者 = 0，可用副本 = 1</li>\n\t\t<li>Brave New World (book_id = 6)：总副本数 = 4，当前借阅者 = 1，可用副本 = 3</li>\n\t</ul>\n\t</li>\n\t<li><strong>结果顺序：</strong>\n\t<ul>\n\t\t<li>The Great Gatsby 有 3 名当前借阅者，排序第一</li>\n\t\t<li>1984 有 1 名当前借阅者，排序第二</li>\n\t</ul>\n\t</li>\n</ul>\n\n<p>输出表以 current_borrowers 降序排序，然后以 book_title 升序排序。</p>\n</div>\n", "templates": [{"value": "mysql", "text": "MySQL", "defaultCode": "# Write your MySQL query statement below"}, {"value": "mssql", "text": "MS SQL Server", "defaultCode": "/* Write your T-SQL query statement below */"}, {"value": "oraclesql", "text": "Oracle", "defaultCode": "/* Write your PL/SQL query statement below */"}, {"value": "pythondata", "text": "Pandas", "defaultCode": "import pandas as pd\n\ndef find_books_with_no_available_copies(library_books: pd.DataFrame, borrowing_records: pd.DataFrame) -> pd.DataFrame:\n    "}, {"value": "postgresql", "text": "PostgreSQL", "defaultCode": "-- Write your PostgreSQL query statement below"}]}