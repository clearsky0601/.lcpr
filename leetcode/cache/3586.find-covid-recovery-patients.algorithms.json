{"id": 3586, "fid": "3586", "name": "寻找 COVID 康复患者", "slug": "find-covid-recovery-patients", "link": "https://leetcode.cn/problems/find-covid-recovery-patients/description/", "percent": 0, "level": "Medium", "category": "algorithms", "en_name": "Find COVID Recovery Patients", "cn_name": "寻找 COVID 康复患者", "desc": "<p>表：<code>patients</code></p>\n\n<pre>\n+-------------+---------+\n| Column Name | Type    |\n+-------------+---------+\n| patient_id  | int     |\n| patient_name| varchar |\n| age         | int     |\n+-------------+---------+\npatient_id 是这张表的唯一主键。\n每一行表示一个患者的信息。\n</pre>\n\n<p>表：<code>covid_tests</code></p>\n\n<pre>\n+-------------+---------+\n| Column Name | Type    |\n+-------------+---------+\n| test_id     | int     |\n| patient_id  | int     |\n| test_date   | date    |\n| result      | varchar |\n+-------------+---------+\ntest_id 是这张表的唯一主键。\n每一行代表一个 COVID 检测结果。结果可以是阳性、阴性或不确定。\n</pre>\n\n<p>编写一个解决方案以找到从 COVID 中康复的患者——那些曾经检测呈阳性但后来检测呈阴性的患者。</p>\n\n<ul>\n\t<li>患者如果 <strong>至少有一次阳性</strong> 检测结果后，在&nbsp;<strong>之后的日期</strong> 至少有一次 <strong>阴性</strong> 检测结果，则被认为已康复。</li>\n\t<li>计算从 <strong>首次阳性检测</strong> 结果到 <strong>该阳性检测</strong> 后的 <strong>首次阴性检测结果</strong> 之间的 <strong>康复时间</strong>（以天为单位）</li>\n\t<li><strong>仅包括&nbsp;</strong>同时具有阳性及阴性检测结果的患者</li>\n</ul>\n\n<p>返回结果表以<em>&nbsp;</em><code>recovery_time</code><em> </em><strong>升序 </strong>排序，然后以<em>&nbsp;</em><code>patient_name</code><em> </em><strong>升序&nbsp;</strong>排序。</p>\n\n<p>结果格式如下所示。</p>\n\n<p>&nbsp;</p>\n\n<p><strong class=\"example\">示例：</strong></p>\n\n<div class=\"example-block\">\n<p><strong>输入：</strong></p>\n\n<p>patients 表：</p>\n\n<pre class=\"example-io\">\n+------------+--------------+-----+\n| patient_id | patient_name | age |\n+------------+--------------+-----+\n| 1          | Alice Smith  | 28  |\n| 2          | Bob Johnson  | 35  |\n| 3          | Carol Davis  | 42  |\n| 4          | David Wilson | 31  |\n| 5          | Emma Brown   | 29  |\n+------------+--------------+-----+\n</pre>\n\n<p>covid_tests 表：</p>\n\n<pre class=\"example-io\">\n+---------+------------+------------+--------------+\n| test_id | patient_id | test_date  | result       |\n+---------+------------+------------+--------------+\n| 1       | 1          | 2023-01-15 | Positive     |\n| 2       | 1          | 2023-01-25 | Negative     |\n| 3       | 2          | 2023-02-01 | Positive     |\n| 4       | 2          | 2023-02-05 | Inconclusive |\n| 5       | 2          | 2023-02-12 | Negative     |\n| 6       | 3          | 2023-01-20 | Negative     |\n| 7       | 3          | 2023-02-10 | Positive     |\n| 8       | 3          | 2023-02-20 | Negative     |\n| 9       | 4          | 2023-01-10 | Positive     |\n| 10      | 4          | 2023-01-18 | Positive     |\n| 11      | 5          | 2023-02-15 | Negative     |\n| 12      | 5          | 2023-02-20 | Negative     |\n+---------+------------+------------+--------------+\n</pre>\n\n<p><strong>输出：</strong></p>\n\n<pre class=\"example-io\">\n+------------+--------------+-----+---------------+\n| patient_id | patient_name | age | recovery_time |\n+------------+--------------+-----+---------------+\n| 1          | Alice Smith  | 28  | 10            |\n| 3          | Carol Davis  | 42  | 10            |\n| 2          | Bob Johnson  | 35  | 11            |\n+------------+--------------+-----+---------------+\n</pre>\n\n<p><strong>解释：</strong></p>\n\n<ul>\n\t<li><strong>Alice Smith (patient_id = 1):</strong>\n\n\t<ul>\n\t\t<li>首次阳性检测：2023-01-15</li>\n\t\t<li>阳性检测后的首次阴性检测：2023-01-25</li>\n\t\t<li>康复时间：25 - 15 = 10 天</li>\n\t</ul>\n\t</li>\n\t<li><strong>Bob Johnson (patient_id = 2):</strong>\n\t<ul>\n\t\t<li>首次阳性检测：2023-02-01</li>\n\t\t<li>测试结果不明确：2023-02-05（忽略计算康复时间）</li>\n\t\t<li>阳性检测后的首次阴性检测：2023-02-12</li>\n\t\t<li>康复时间：12 - 1 = 11 天</li>\n\t</ul>\n\t</li>\n\t<li><strong>Carol Davis (patient_id = 3):</strong>\n\t<ul>\n\t\t<li>检测呈阴性：2023-01-20（在阳性检测前）</li>\n\t\t<li>首次阳性检测：2023-02-10</li>\n\t\t<li>阳性检测后的首次阴性检测：2023-02-20</li>\n\t\t<li>康复时间：20 - 10 = 10 天</li>\n\t</ul>\n\t</li>\n\t<li><strong>没有包含的患者：</strong>\n\t<ul>\n\t\t<li>David Wilson（patient_id = 4）：只有阳性检测，之后没有阴性检测。</li>\n\t\t<li>Emma Brown（patient_id = 5）：只有阴性检测，从未有阳性检测。</li>\n\t</ul>\n\t</li>\n</ul>\n\n<p>输出表以 recovery_time 升序排序，然后以 patient_name 升序排序。</p>\n</div>\n", "templates": [{"value": "mysql", "text": "MySQL", "defaultCode": "# Write your MySQL query statement below"}, {"value": "mssql", "text": "MS SQL Server", "defaultCode": "/* Write your T-SQL query statement below */"}, {"value": "oraclesql", "text": "Oracle", "defaultCode": "/* Write your PL/SQL query statement below */"}, {"value": "pythondata", "text": "Pandas", "defaultCode": "import pandas as pd\n\ndef find_covid_recovery_patients(patients: pd.DataFrame, covid_tests: pd.DataFrame) -> pd.DataFrame:\n    "}, {"value": "postgresql", "text": "PostgreSQL", "defaultCode": "-- Write your PostgreSQL query statement below"}]}