{"id": 3554, "fid": "3554", "name": "查找类别推荐对", "slug": "find-category-recommendation-pairs", "link": "https://leetcode.cn/problems/find-category-recommendation-pairs/description/", "percent": 0, "level": "Hard", "category": "algorithms", "en_name": "Find Category Recommendation Pairs", "cn_name": "查找类别推荐对", "desc": "<p>表：<code>ProductPurchases</code></p>\n\n<pre>\n+-------------+------+\n| Column Name | Type | \n+-------------+------+\n| user_id     | int  |\n| product_id  | int  |\n| quantity    | int  |\n+-------------+------+\n(user_id, product_id) 是这张表的唯一主键。\n每一行代表用户以特定数量购买的一种产品。\n</pre>\n\n<p>表：<code>ProductInfo</code></p>\n\n<pre>\n+-------------+---------+\n| Column Name | Type    | \n+-------------+---------+\n| product_id  | int     |\n| category    | varchar |\n| price       | decimal |\n+-------------+---------+\nproduct_id 是这张表的唯一主键。\n每一行表示一件商品的类别和价格。\n</pre>\n\n<p>亚马逊想要了解不同产品类别的购物模式。编写一个解决方案：</p>\n\n<ol>\n\t<li>查找所有 <strong>类别对</strong>（其中&nbsp;<code>category1</code> &lt; <code>category2</code>）</li>\n\t<li>对于 <strong>每个类别对</strong>，确定 <strong>同时</strong> 购买了两类别产品的 <strong>不同用户</strong> 数量</li>\n</ol>\n\n<p>如果至少有 <code>3</code> 个不同的客户购买了两个类别的产品，则类别对被视为 <strong>可报告的</strong>。</p>\n\n<p>返回可报告类别对的结果表以<em>&nbsp;</em><strong>customer_count</strong><em>&nbsp;</em><strong>降序</strong><em> </em>排序，并且为了防止排序持平，以<em>&nbsp;</em><strong>category1 </strong>字典序<strong> 升序</strong>&nbsp;排序，然后以&nbsp;<strong>category2 升序</strong>&nbsp;排序。</p>\n\n<p>结果格式如下所示。</p>\n\n<p>&nbsp;</p>\n\n<p><strong class=\"example\">示例：</strong></p>\n\n<div class=\"example-block\">\n<p><strong>输入：</strong></p>\n\n<p>ProductPurchases 表：</p>\n\n<pre class=\"example-io\">\n+---------+------------+----------+\n| user_id | product_id | quantity |\n+---------+------------+----------+\n| 1       | 101        | 2        |\n| 1       | 102        | 1        |\n| 1       | 201        | 3        |\n| 1       | 301        | 1        |\n| 2       | 101        | 1        |\n| 2       | 102        | 2        |\n| 2       | 103        | 1        |\n| 2       | 201        | 5        |\n| 3       | 101        | 2        |\n| 3       | 103        | 1        |\n| 3       | 301        | 4        |\n| 3       | 401        | 2        |\n| 4       | 101        | 1        |\n| 4       | 201        | 3        |\n| 4       | 301        | 1        |\n| 4       | 401        | 2        |\n| 5       | 102        | 2        |\n| 5       | 103        | 1        |\n| 5       | 201        | 2        |\n| 5       | 202        | 3        |\n+---------+------------+----------+\n</pre>\n\n<p>ProductInfo 表：</p>\n\n<pre class=\"example-io\">\n+------------+-------------+-------+\n| product_id | category    | price |\n+------------+-------------+-------+\n| 101        | Electronics | 100   |\n| 102        | Books       | 20    |\n| 103        | Books       | 35    |\n| 201        | Clothing    | 45    |\n| 202        | Clothing    | 60    |\n| 301        | Sports      | 75    |\n| 401        | Kitchen     | 50    |\n+------------+-------------+-------+\n</pre>\n\n<p><strong>输出：</strong></p>\n\n<pre class=\"example-io\">\n+-------------+-------------+----------------+\n| category1   | category2   | customer_count |\n+-------------+-------------+----------------+\n| Books       | Clothing    | 3              |\n| Books       | Electronics | 3              |\n| Clothing    | Electronics | 3              |\n| Electronics | Sports      | 3              |\n+-------------+-------------+----------------+\n</pre>\n\n<p><strong>解释：</strong></p>\n\n<ul>\n\t<li><strong>Books-Clothing</strong>:\n\n\t<ul>\n\t\t<li>用户 1 购买来自 Books (102) 和 Clothing (201) 的商品</li>\n\t\t<li>用户 2 购买来自 Books (102, 103) 和 Clothing (201) 的商品</li>\n\t\t<li>用户 5 购买来自 Books (102, 103) 和 Clothing (201, 202) 的商品</li>\n\t\t<li>共计：3 个用户购买同一类别的商品</li>\n\t</ul>\n\t</li>\n\t<li><strong>Books-Electronics</strong>:\n\t<ul>\n\t\t<li>用户 1 购买来自 Books (102) 和 Electronics (101) 的商品</li>\n\t\t<li>用户 2 购买来自 Books (102, 103) 和 Electronics (101)&nbsp;的商品</li>\n\t\t<li>用户 3&nbsp;购买来自 Books (103) 和 Electronics (101)&nbsp;的商品</li>\n\t\t<li>共计：3 个消费者购买同一类别的商品</li>\n\t</ul>\n\t</li>\n\t<li><strong>Clothing-Electronics</strong>:\n\t<ul>\n\t\t<li>用户 1 购买来自 Clothing (201) 和 Electronics (101) 的商品</li>\n\t\t<li>用户 2 购买来自 Clothing (201) 和 Electronics (101) 的商品</li>\n\t\t<li>用户 4&nbsp;购买来自 Clothing (201) 和 Electronics (101) 的商品</li>\n\t\t<li>共计：3 个消费者购买同一类别的商品</li>\n\t</ul>\n\t</li>\n\t<li><strong>Electronics-Sports</strong>:\n\t<ul>\n\t\t<li>用户 1 购买来自 Electronics (101) 和 Sports (301) 的商品</li>\n\t\t<li>用户 3&nbsp;购买来自 Electronics (101) 和 Sports (301) 的商品</li>\n\t\t<li>用户 4&nbsp;购买来自 Electronics (101) 和 Sports (301) 的商品</li>\n\t\t<li>共计：3 个消费者购买同一类别的商品</li>\n\t</ul>\n\t</li>\n\t<li>其它类别对比如 Clothing-Sports（只有 2 个消费者：用户 1 和 4）和 Books-Kitchen（只有 1 个消费者：用户 3）共同的消费者少于 3 个，因此不包含在结果内。</li>\n</ul>\n\n<p>结果按&nbsp;customer_count 降序排列。由于所有对都有相同的客户数量 3，它们按 category1（然后是 category2）升序排列。</p>\n</div>\n", "templates": [{"value": "mysql", "text": "MySQL", "defaultCode": "# Write your MySQL query statement below"}, {"value": "mssql", "text": "MS SQL Server", "defaultCode": "/* Write your T-SQL query statement below */"}, {"value": "oraclesql", "text": "Oracle", "defaultCode": "/* Write your PL/SQL query statement below */"}, {"value": "pythondata", "text": "Pandas", "defaultCode": "import pandas as pd\n\ndef find_category_recommendation_pairs(product_purchases: pd.DataFrame, product_info: pd.DataFrame) -> pd.DataFrame:\n    "}, {"value": "postgresql", "text": "PostgreSQL", "defaultCode": "-- Write your PostgreSQL query statement below"}]}