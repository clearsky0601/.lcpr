{"id": 1797, "fid": "1797", "name": "设计一个验证系统", "slug": "design-authentication-manager", "link": "https://leetcode.cn/problems/design-authentication-manager/description/", "percent": 0, "level": "Medium", "category": "algorithms", "en_name": "Design Authentication Manager", "cn_name": "设计一个验证系统", "desc": "<p>你需要设计一个包含验证码的验证系统。每一次验证中，用户会收到一个新的验证码，这个验证码在 <code>currentTime</code> 时刻之后 <code>timeToLive</code> 秒过期。如果验证码被更新了，那么它会在 <code>currentTime</code> （可能与之前的 <code>currentTime</code> 不同）时刻延长 <code>timeToLive</code> 秒。</p>\n\n<p>请你实现 <code>AuthenticationManager</code> 类：</p>\n\n<ul>\n\t<li><code>AuthenticationManager(int timeToLive)</code> 构造 <code>AuthenticationManager</code> 并设置 <code>timeToLive</code> 参数。</li>\n\t<li><code>generate(string tokenId, int currentTime)</code> 给定 <code>tokenId</code> ，在当前时间 <code>currentTime</code> 生成一个新的验证码。</li>\n\t<li><code>renew(string tokenId, int currentTime)</code> 将给定 <code>tokenId</code> 且 <strong>未过期</strong> 的验证码在 <code>currentTime</code> 时刻更新。如果给定 <code>tokenId</code> 对应的验证码不存在或已过期，请你忽略该操作，不会有任何更新操作发生。</li>\n\t<li><code>countUnexpiredTokens(int currentTime)</code> 请返回在给定 <code>currentTime</code> 时刻，<strong>未过期</strong> 的验证码数目。</li>\n</ul>\n\n<p>如果一个验证码在时刻 <code>t</code> 过期，且另一个操作恰好在时刻 <code>t</code> 发生（<code>renew</code> 或者 <code>countUnexpiredTokens</code> 操作），过期事件 <strong>优先于</strong> 其他操作。</p>\n\n<p> </p>\n\n<p><strong>示例 1：</strong></p>\n<img alt=\"\" src=\"https://assets.leetcode.com/uploads/2021/02/25/copy-of-pc68_q2.png\" style=\"width: 500px; height: 287px;\" />\n<pre>\n<strong>输入：</strong>\n[\"AuthenticationManager\", \"<code>renew</code>\", \"generate\", \"<code>countUnexpiredTokens</code>\", \"generate\", \"<code>renew</code>\", \"<code>renew</code>\", \"<code>countUnexpiredTokens</code>\"]\n[[5], [\"aaa\", 1], [\"aaa\", 2], [6], [\"bbb\", 7], [\"aaa\", 8], [\"bbb\", 10], [15]]\n<strong>输出：</strong>\n[null, null, null, 1, null, null, null, 0]\n\n<strong>解释：</strong>\nAuthenticationManager authenticationManager = new AuthenticationManager(5); // 构造 AuthenticationManager ，设置 <code>timeToLive</code> = 5 秒。\nauthenticationManager.<code>renew</code>(\"aaa\", 1); // 时刻 1 时，没有验证码的 tokenId 为 \"aaa\" ，没有验证码被更新。\nauthenticationManager.generate(\"aaa\", 2); // 时刻 2 时，生成一个 tokenId 为 \"aaa\" 的新验证码。\nauthenticationManager.<code>countUnexpiredTokens</code>(6); // 时刻 6 时，只有 tokenId 为 \"aaa\" 的验证码未过期，所以返回 1 。\nauthenticationManager.generate(\"bbb\", 7); // 时刻 7 时，生成一个 tokenId 为 \"bbb\" 的新验证码。\nauthenticationManager.<code>renew</code>(\"aaa\", 8); // tokenId 为 \"aaa\" 的验证码在时刻 7 过期，且 8 >= 7 ，所以时刻 8 的renew 操作被忽略，没有验证码被更新。\nauthenticationManager.<code>renew</code>(\"bbb\", 10); // tokenId 为 \"bbb\" 的验证码在时刻 10 没有过期，所以 renew 操作会执行，该 token 将在时刻 15 过期。\nauthenticationManager.<code>countUnexpiredTokens</code>(15); // tokenId 为 \"bbb\" 的验证码在时刻 15 过期，tokenId 为 \"aaa\" 的验证码在时刻 7 过期，所有验证码均已过期，所以返回 0 。\n</pre>\n\n<p> </p>\n\n<p><strong>提示：</strong></p>\n\n<ul>\n\t<li><code>1 <= timeToLive <= 10<sup>8</sup></code></li>\n\t<li><code>1 <= currentTime <= 10<sup>8</sup></code></li>\n\t<li><code>1 <= tokenId.length <= 5</code></li>\n\t<li><code>tokenId</code> 只包含小写英文字母。</li>\n\t<li>所有 <code>generate</code> 函数的调用都会包含独一无二的 <code>tokenId</code> 值。</li>\n\t<li>所有函数调用中，<code>currentTime</code> 的值 <strong>严格递增</strong> 。</li>\n\t<li>所有函数的调用次数总共不超过 <code>2000</code> 次。</li>\n</ul>\n", "templates": [{"value": "cpp", "text": "C++", "defaultCode": "class AuthenticationManager {\npublic:\n    AuthenticationManager(int timeToLive) {\n        \n    }\n    \n    void generate(string tokenId, int currentTime) {\n        \n    }\n    \n    void renew(string tokenId, int currentTime) {\n        \n    }\n    \n    int countUnexpiredTokens(int currentTime) {\n        \n    }\n};\n\n/**\n * Your AuthenticationManager object will be instantiated and called as such:\n * AuthenticationManager* obj = new AuthenticationManager(timeToLive);\n * obj->generate(tokenId,currentTime);\n * obj->renew(tokenId,currentTime);\n * int param_3 = obj->countUnexpiredTokens(currentTime);\n */"}, {"value": "java", "text": "Java", "defaultCode": "class AuthenticationManager {\n\n    public AuthenticationManager(int timeToLive) {\n        \n    }\n    \n    public void generate(String tokenId, int currentTime) {\n        \n    }\n    \n    public void renew(String tokenId, int currentTime) {\n        \n    }\n    \n    public int countUnexpiredTokens(int currentTime) {\n        \n    }\n}\n\n/**\n * Your AuthenticationManager object will be instantiated and called as such:\n * AuthenticationManager obj = new AuthenticationManager(timeToLive);\n * obj.generate(tokenId,currentTime);\n * obj.renew(tokenId,currentTime);\n * int param_3 = obj.countUnexpiredTokens(currentTime);\n */"}, {"value": "python", "text": "Python", "defaultCode": "class AuthenticationManager(object):\n\n    def __init__(self, timeToLive):\n        \"\"\"\n        :type timeToLive: int\n        \"\"\"\n        \n\n    def generate(self, tokenId, currentTime):\n        \"\"\"\n        :type tokenId: str\n        :type currentTime: int\n        :rtype: None\n        \"\"\"\n        \n\n    def renew(self, tokenId, currentTime):\n        \"\"\"\n        :type tokenId: str\n        :type currentTime: int\n        :rtype: None\n        \"\"\"\n        \n\n    def countUnexpiredTokens(self, currentTime):\n        \"\"\"\n        :type currentTime: int\n        :rtype: int\n        \"\"\"\n        \n\n\n# Your AuthenticationManager object will be instantiated and called as such:\n# obj = AuthenticationManager(timeToLive)\n# obj.generate(tokenId,currentTime)\n# obj.renew(tokenId,currentTime)\n# param_3 = obj.countUnexpiredTokens(currentTime)"}, {"value": "python3", "text": "Python3", "defaultCode": "class AuthenticationManager:\n\n    def __init__(self, timeToLive: int):\n        \n\n    def generate(self, tokenId: str, currentTime: int) -> None:\n        \n\n    def renew(self, tokenId: str, currentTime: int) -> None:\n        \n\n    def countUnexpiredTokens(self, currentTime: int) -> int:\n        \n\n\n# Your AuthenticationManager object will be instantiated and called as such:\n# obj = AuthenticationManager(timeToLive)\n# obj.generate(tokenId,currentTime)\n# obj.renew(tokenId,currentTime)\n# param_3 = obj.countUnexpiredTokens(currentTime)"}, {"value": "c", "text": "C", "defaultCode": "\n\n\ntypedef struct {\n    \n} AuthenticationManager;\n\n\nAuthenticationManager* authenticationManagerCreate(int timeToLive) {\n    \n}\n\nvoid authenticationManagerGenerate(AuthenticationManager* obj, char* tokenId, int currentTime) {\n    \n}\n\nvoid authenticationManagerRenew(AuthenticationManager* obj, char* tokenId, int currentTime) {\n    \n}\n\nint authenticationManagerCountUnexpiredTokens(AuthenticationManager* obj, int currentTime) {\n    \n}\n\nvoid authenticationManagerFree(AuthenticationManager* obj) {\n    \n}\n\n/**\n * Your AuthenticationManager struct will be instantiated and called as such:\n * AuthenticationManager* obj = authenticationManagerCreate(timeToLive);\n * authenticationManagerGenerate(obj, tokenId, currentTime);\n \n * authenticationManagerRenew(obj, tokenId, currentTime);\n \n * int param_3 = authenticationManagerCountUnexpiredTokens(obj, currentTime);\n \n * authenticationManagerFree(obj);\n*/"}, {"value": "csharp", "text": "C#", "defaultCode": "public class AuthenticationManager {\n\n    public AuthenticationManager(int timeToLive) {\n        \n    }\n    \n    public void Generate(string tokenId, int currentTime) {\n        \n    }\n    \n    public void Renew(string tokenId, int currentTime) {\n        \n    }\n    \n    public int CountUnexpiredTokens(int currentTime) {\n        \n    }\n}\n\n/**\n * Your AuthenticationManager object will be instantiated and called as such:\n * AuthenticationManager obj = new AuthenticationManager(timeToLive);\n * obj.Generate(tokenId,currentTime);\n * obj.Renew(tokenId,currentTime);\n * int param_3 = obj.CountUnexpiredTokens(currentTime);\n */"}, {"value": "javascript", "text": "JavaScript", "defaultCode": "/**\n * @param {number} timeToLive\n */\nvar AuthenticationManager = function(timeToLive) {\n    \n};\n\n/** \n * @param {string} tokenId \n * @param {number} currentTime\n * @return {void}\n */\nAuthenticationManager.prototype.generate = function(tokenId, currentTime) {\n    \n};\n\n/** \n * @param {string} tokenId \n * @param {number} currentTime\n * @return {void}\n */\nAuthenticationManager.prototype.renew = function(tokenId, currentTime) {\n    \n};\n\n/** \n * @param {number} currentTime\n * @return {number}\n */\nAuthenticationManager.prototype.countUnexpiredTokens = function(currentTime) {\n    \n};\n\n/** \n * Your AuthenticationManager object will be instantiated and called as such:\n * var obj = new AuthenticationManager(timeToLive)\n * obj.generate(tokenId,currentTime)\n * obj.renew(tokenId,currentTime)\n * var param_3 = obj.countUnexpiredTokens(currentTime)\n */"}, {"value": "typescript", "text": "TypeScript", "defaultCode": "class AuthenticationManager {\n    constructor(timeToLive: number) {\n        \n    }\n\n    generate(tokenId: string, currentTime: number): void {\n        \n    }\n\n    renew(tokenId: string, currentTime: number): void {\n        \n    }\n\n    countUnexpiredTokens(currentTime: number): number {\n        \n    }\n}\n\n/**\n * Your AuthenticationManager object will be instantiated and called as such:\n * var obj = new AuthenticationManager(timeToLive)\n * obj.generate(tokenId,currentTime)\n * obj.renew(tokenId,currentTime)\n * var param_3 = obj.countUnexpiredTokens(currentTime)\n */"}, {"value": "php", "text": "PHP", "defaultCode": "class AuthenticationManager {\n    /**\n     * @param Integer $timeToLive\n     */\n    function __construct($timeToLive) {\n        \n    }\n  \n    /**\n     * @param String $tokenId\n     * @param Integer $currentTime\n     * @return NULL\n     */\n    function generate($tokenId, $currentTime) {\n        \n    }\n  \n    /**\n     * @param String $tokenId\n     * @param Integer $currentTime\n     * @return NULL\n     */\n    function renew($tokenId, $currentTime) {\n        \n    }\n  \n    /**\n     * @param Integer $currentTime\n     * @return Integer\n     */\n    function countUnexpiredTokens($currentTime) {\n        \n    }\n}\n\n/**\n * Your AuthenticationManager object will be instantiated and called as such:\n * $obj = AuthenticationManager($timeToLive);\n * $obj->generate($tokenId, $currentTime);\n * $obj->renew($tokenId, $currentTime);\n * $ret_3 = $obj->countUnexpiredTokens($currentTime);\n */"}, {"value": "swift", "text": "Swift", "defaultCode": "\nclass AuthenticationManager {\n\n    init(_ timeToLive: Int) {\n        \n    }\n    \n    func generate(_ tokenId: String, _ currentTime: Int) {\n        \n    }\n    \n    func renew(_ tokenId: String, _ currentTime: Int) {\n        \n    }\n    \n    func countUnexpiredTokens(_ currentTime: Int) -> Int {\n        \n    }\n}\n\n/**\n * Your AuthenticationManager object will be instantiated and called as such:\n * let obj = AuthenticationManager(timeToLive)\n * obj.generate(tokenId, currentTime)\n * obj.renew(tokenId, currentTime)\n * let ret_3: Int = obj.countUnexpiredTokens(currentTime)\n */"}, {"value": "kotlin", "text": "Kotlin", "defaultCode": "class AuthenticationManager(timeToLive: Int) {\n\n    fun generate(tokenId: String, currentTime: Int) {\n        \n    }\n\n    fun renew(tokenId: String, currentTime: Int) {\n        \n    }\n\n    fun countUnexpiredTokens(currentTime: Int): Int {\n        \n    }\n\n}\n\n/**\n * Your AuthenticationManager object will be instantiated and called as such:\n * var obj = AuthenticationManager(timeToLive)\n * obj.generate(tokenId,currentTime)\n * obj.renew(tokenId,currentTime)\n * var param_3 = obj.countUnexpiredTokens(currentTime)\n */"}, {"value": "dart", "text": "Dart", "defaultCode": "class AuthenticationManager {\n\n  AuthenticationManager(int timeToLive) {\n    \n  }\n  \n  void generate(String tokenId, int currentTime) {\n    \n  }\n  \n  void renew(String tokenId, int currentTime) {\n    \n  }\n  \n  int countUnexpiredTokens(int currentTime) {\n    \n  }\n}\n\n/**\n * Your AuthenticationManager object will be instantiated and called as such:\n * AuthenticationManager obj = AuthenticationManager(timeToLive);\n * obj.generate(tokenId,currentTime);\n * obj.renew(tokenId,currentTime);\n * int param3 = obj.countUnexpiredTokens(currentTime);\n */"}, {"value": "golang", "text": "Go", "defaultCode": "type AuthenticationManager struct {\n    \n}\n\n\nfunc Constructor(timeToLive int) AuthenticationManager {\n    \n}\n\n\nfunc (this *AuthenticationManager) Generate(tokenId string, currentTime int)  {\n    \n}\n\n\nfunc (this *AuthenticationManager) Renew(tokenId string, currentTime int)  {\n    \n}\n\n\nfunc (this *AuthenticationManager) CountUnexpiredTokens(currentTime int) int {\n    \n}\n\n\n/**\n * Your AuthenticationManager object will be instantiated and called as such:\n * obj := Constructor(timeToLive);\n * obj.Generate(tokenId,currentTime);\n * obj.Renew(tokenId,currentTime);\n * param_3 := obj.CountUnexpiredTokens(currentTime);\n */"}, {"value": "ruby", "text": "Ruby", "defaultCode": "class AuthenticationManager\n\n=begin\n    :type time_to_live: Integer\n=end\n    def initialize(time_to_live)\n        \n    end\n\n\n=begin\n    :type token_id: String\n    :type current_time: Integer\n    :rtype: Void\n=end\n    def generate(token_id, current_time)\n        \n    end\n\n\n=begin\n    :type token_id: String\n    :type current_time: Integer\n    :rtype: Void\n=end\n    def renew(token_id, current_time)\n        \n    end\n\n\n=begin\n    :type current_time: Integer\n    :rtype: Integer\n=end\n    def count_unexpired_tokens(current_time)\n        \n    end\n\n\nend\n\n# Your AuthenticationManager object will be instantiated and called as such:\n# obj = AuthenticationManager.new(time_to_live)\n# obj.generate(token_id, current_time)\n# obj.renew(token_id, current_time)\n# param_3 = obj.count_unexpired_tokens(current_time)"}, {"value": "scala", "text": "Scala", "defaultCode": "class AuthenticationManager(_timeToLive: Int) {\n\n    def generate(tokenId: String, currentTime: Int): Unit = {\n        \n    }\n\n    def renew(tokenId: String, currentTime: Int): Unit = {\n        \n    }\n\n    def countUnexpiredTokens(currentTime: Int): Int = {\n        \n    }\n\n}\n\n/**\n * Your AuthenticationManager object will be instantiated and called as such:\n * val obj = new AuthenticationManager(timeToLive)\n * obj.generate(tokenId,currentTime)\n * obj.renew(tokenId,currentTime)\n * val param_3 = obj.countUnexpiredTokens(currentTime)\n */"}, {"value": "rust", "text": "Rust", "defaultCode": "struct AuthenticationManager {\n\n}\n\n\n/** \n * `&self` means the method takes an immutable reference.\n * If you need a mutable reference, change it to `&mut self` instead.\n */\nimpl AuthenticationManager {\n\n    fn new(timeToLive: i32) -> Self {\n        \n    }\n    \n    fn generate(&self, token_id: String, current_time: i32) {\n        \n    }\n    \n    fn renew(&self, token_id: String, current_time: i32) {\n        \n    }\n    \n    fn count_unexpired_tokens(&self, current_time: i32) -> i32 {\n        \n    }\n}\n\n/**\n * Your AuthenticationManager object will be instantiated and called as such:\n * let obj = AuthenticationManager::new(timeToLive);\n * obj.generate(tokenId, currentTime);\n * obj.renew(tokenId, currentTime);\n * let ret_3: i32 = obj.count_unexpired_tokens(currentTime);\n */"}, {"value": "racket", "text": "Racket", "defaultCode": "(define authentication-manager%\n  (class object%\n    (super-new)\n    \n    ; time-to-live : exact-integer?\n    (init-field\n      time-to-live)\n    \n    ; generate : string? exact-integer? -> void?\n    (define/public (generate token-id current-time)\n      )\n    ; renew : string? exact-integer? -> void?\n    (define/public (renew token-id current-time)\n      )\n    ; count-unexpired-tokens : exact-integer? -> exact-integer?\n    (define/public (count-unexpired-tokens current-time)\n      )))\n\n;; Your authentication-manager% object will be instantiated and called as such:\n;; (define obj (new authentication-manager% [time-to-live time-to-live]))\n;; (send obj generate token-id current-time)\n;; (send obj renew token-id current-time)\n;; (define param_3 (send obj count-unexpired-tokens current-time))"}, {"value": "erlang", "text": "Erlang", "defaultCode": "-spec authentication_manager_init_(TimeToLive :: integer()) -> any().\nauthentication_manager_init_(TimeToLive) ->\n  .\n\n-spec authentication_manager_generate(TokenId :: unicode:unicode_binary(), CurrentTime :: integer()) -> any().\nauthentication_manager_generate(TokenId, CurrentTime) ->\n  .\n\n-spec authentication_manager_renew(TokenId :: unicode:unicode_binary(), CurrentTime :: integer()) -> any().\nauthentication_manager_renew(TokenId, CurrentTime) ->\n  .\n\n-spec authentication_manager_count_unexpired_tokens(CurrentTime :: integer()) -> integer().\nauthentication_manager_count_unexpired_tokens(CurrentTime) ->\n  .\n\n\n%% Your functions will be called as such:\n%% authentication_manager_init_(TimeToLive),\n%% authentication_manager_generate(TokenId, CurrentTime),\n%% authentication_manager_renew(TokenId, CurrentTime),\n%% Param_3 = authentication_manager_count_unexpired_tokens(CurrentTime),\n\n%% authentication_manager_init_ will be called before every test case, in which you can do some necessary initializations."}, {"value": "elixir", "text": "Elixir", "defaultCode": "defmodule AuthenticationManager do\n  @spec init_(time_to_live :: integer) :: any\n  def init_(time_to_live) do\n    \n  end\n\n  @spec generate(token_id :: String.t, current_time :: integer) :: any\n  def generate(token_id, current_time) do\n    \n  end\n\n  @spec renew(token_id :: String.t, current_time :: integer) :: any\n  def renew(token_id, current_time) do\n    \n  end\n\n  @spec count_unexpired_tokens(current_time :: integer) :: integer\n  def count_unexpired_tokens(current_time) do\n    \n  end\nend\n\n# Your functions will be called as such:\n# AuthenticationManager.init_(time_to_live)\n# AuthenticationManager.generate(token_id, current_time)\n# AuthenticationManager.renew(token_id, current_time)\n# param_3 = AuthenticationManager.count_unexpired_tokens(current_time)\n\n# AuthenticationManager.init_ will be called before every test case, in which you can do some necessary initializations."}, {"value": "cangjie", "text": "Cangjie", "defaultCode": "class AuthenticationManager {\n    init(timeToLive: Int64) {\n\n    }\n    \n    func generate(tokenId: String, currentTime: Int64): Unit {\n\n    }\n    \n    func renew(tokenId: String, currentTime: Int64): Unit {\n\n    }\n    \n    func countUnexpiredTokens(currentTime: Int64): Int64 {\n\n    }\n}\n\n/**\n * Your AuthenticationManager object will be instantiated and called as such:\n * let obj: AuthenticationManager = AuthenticationManager(timeToLive)\n * obj.generate(tokenId,currentTime)\n * obj.renew(tokenId,currentTime)\n * let param_3 = obj.countUnexpiredTokens(currentTime)\n */"}]}