{"id": 3626, "fid": "3626", "name": "查找库存不平衡的店铺", "slug": "find-stores-with-inventory-imbalance", "link": "https://leetcode.cn/problems/find-stores-with-inventory-imbalance/description/", "percent": 0, "level": "Medium", "category": "algorithms", "en_name": "Find Stores with Inventory Imbalance", "cn_name": "查找库存不平衡的店铺", "desc": "<p>表：<code>stores</code></p>\n\n<pre>\n+-------------+---------+\n| Column Name | Type    |\n+-------------+---------+\n| store_id    | int     |\n| store_name  | varchar |\n| location    | varchar |\n+-------------+---------+\nstore_id 是这张表的唯一主键。\n每一行包含有关商店及其位置的信息。\n</pre>\n\n<p>表：<code>inventory</code></p>\n\n<pre>\n+-------------+---------+\n| Column Name | Type    |\n+-------------+---------+\n| inventory_id| int     |\n| store_id    | int     |\n| product_name| varchar |\n| quantity    | int     |\n| price       | decimal |\n+-------------+---------+\ninventory_id 是这张表的唯一主键。\n每一行代表特定商店中某一特定产品的库存情况。\n</pre>\n\n<p>编写一个解决方案来查找库存不平衡的商店 - 即最贵商品的库存比最便宜商品少的商店。</p>\n\n<ul>\n\t<li>对于每个商店，识别 <strong>最贵的商品</strong>（最高价格）及其数量，如果有多个最贵的商品则选取数量最多的一个。</li>\n\t<li>对于每个商店，识别 <strong>最便宜的商品</strong>（最低价格）及其数量，如果有多个最便宜的物品则选取数量最多的一个。</li>\n\t<li>如果最贵商品的数量 <strong>少于</strong> 最便宜商品的数量，则商店存在库存不平衡。</li>\n\t<li>按（最便宜商品的数量/最贵商品的数量）计算 <strong>不平衡比</strong>。</li>\n\t<li>不平衡比&nbsp;<strong>舍入到 2 位</strong>&nbsp;小数</li>\n\t<li>结果只包含&nbsp;<strong>至少有</strong><strong> </strong><code>3</code>&nbsp;<strong>个不同商品</strong> 的店铺</li>\n</ul>\n\n<p>返回结果表以不平衡比率降序排列，然后按商店名称升序排列。</p>\n\n<p>结果格式如下所示。</p>\n\n<p>&nbsp;</p>\n\n<p><strong class=\"example\">示例：</strong></p>\n\n<div class=\"example-block\">\n<p><strong>输入：</strong></p>\n\n<p>stores 表：</p>\n\n<pre class=\"example-io\">\n+----------+----------------+-------------+\n| store_id | store_name     | location    |\n+----------+----------------+-------------+\n| 1        | Downtown Tech  | New York    |\n| 2        | Suburb Mall    | Chicago     |\n| 3        | City Center    | Los Angeles |\n| 4        | Corner Shop    | Miami       |\n| 5        | Plaza Store    | Seattle     |\n+----------+----------------+-------------+\n</pre>\n\n<p>inventory 表：</p>\n\n<pre class=\"example-io\">\n+--------------+----------+--------------+----------+--------+\n| inventory_id | store_id | product_name | quantity | price  |\n+--------------+----------+--------------+----------+--------+\n| 1            | 1        | Laptop       | 5        | 999.99 |\n| 2            | 1        | Mouse        | 50       | 19.99  |\n| 3            | 1        | Keyboard     | 25       | 79.99  |\n| 4            | 1        | Monitor      | 15       | 299.99 |\n| 5            | 2        | Phone        | 3        | 699.99 |\n| 6            | 2        | Charger      | 100      | 25.99  |\n| 7            | 2        | Case         | 75       | 15.99  |\n| 8            | 2        | Headphones   | 20       | 149.99 |\n| 9            | 3        | Tablet       | 2        | 499.99 |\n| 10           | 3        | Stylus       | 80       | 29.99  |\n| 11           | 3        | Cover        | 60       | 39.99  |\n| 12           | 4        | Watch        | 10       | 299.99 |\n| 13           | 4        | Band         | 25       | 49.99  |\n| 14           | 5        | Camera       | 8        | 599.99 |\n| 15           | 5        | Lens         | 12       | 199.99 |\n+--------------+----------+--------------+----------+--------+\n</pre>\n\n<p><strong>输出：</strong></p>\n\n<pre class=\"example-io\">\n+----------+----------------+-------------+------------------+--------------------+------------------+\n| store_id | store_name     | location    | most_exp_product | cheapest_product   | imbalance_ratio  |\n+----------+----------------+-------------+------------------+--------------------+------------------+\n| 3        | City Center    | Los Angeles | Tablet           | Stylus             | 40.00            |\n| 1        | Downtown Tech  | New York    | Laptop           | Mouse              | 10.00            |\n| 2        | Suburb Mall    | Chicago     | Phone            | Case               | 25.00            |\n+----------+----------------+-------------+------------------+--------------------+------------------+\n</pre>\n\n<p><strong>解释：</strong></p>\n\n<ul>\n\t<li><strong>Downtown Tech (store_id = 1)：</strong>\n\n\t<ul>\n\t\t<li>最贵的商品：笔记本（$999.99）数量为 5</li>\n\t\t<li>最便宜的商品：鼠标（$19.99）数量为 50</li>\n\t\t<li>库存不平衡：5 &lt; 50（贵的商品的库存更少）</li>\n\t\t<li>不平衡比：50 / 5 = 10.00</li>\n\t\t<li>有 4&nbsp;件商品（≥ 3），所以满足要求</li>\n\t</ul>\n\t</li>\n\t<li><strong>Suburb Mall (store_id = 2)：</strong>\n\t<ul>\n\t\t<li>最贵的商品：手机（$699.99）数量为 3</li>\n\t\t<li>最便宜的商品：保护壳（$15.99）数量为75</li>\n\t\t<li>库存不平衡：3 &lt; 75（贵的商品的库存更少）</li>\n\t\t<li>不平衡比：75 / 3 = 25.00</li>\n\t\t<li>有 4&nbsp;件商品（≥ 3），所以满足要求</li>\n\t</ul>\n\t</li>\n\t<li><strong>City Center (store_id = 3)：</strong>\n\t<ul>\n\t\t<li>最贵的商品：平板电脑（$499.99）数量为 2</li>\n\t\t<li>最便宜的商品：触控笔（$29.99）数量为 80</li>\n\t\t<li>不平衡比：2 &lt; 80（贵的商品的库存更少）</li>\n\t\t<li>不平衡比：80 / 2 = 40.00</li>\n\t\t<li>有 3 件商品（≥ 3），所以满足要求</li>\n\t</ul>\n\t</li>\n\t<li><strong>未包含的商店：</strong>\n\t<ul>\n\t\t<li>Corner Shop（store_id = 4）：只有两件商品（手表，手环）- 不满足最少 3 件商品的要求</li>\n\t\t<li>Plaza Store（store_id = 5）：只有两件商品（相机，镜头）- 不满足最少 3 件商品的要求</li>\n\t</ul>\n\t</li>\n</ul>\n\n<p>结果表按不平衡比降序排序，然后以商店名升序排序。</p>\n</div>\n", "templates": [{"value": "mysql", "text": "MySQL", "defaultCode": "# Write your MySQL query statement below"}, {"value": "mssql", "text": "MS SQL Server", "defaultCode": "/* Write your T-SQL query statement below */"}, {"value": "oraclesql", "text": "Oracle", "defaultCode": "/* Write your PL/SQL query statement below */"}, {"value": "pythondata", "text": "Pandas", "defaultCode": "import pandas as pd\n\ndef find_inventory_imbalance(stores: pd.DataFrame, inventory: pd.DataFrame) -> pd.DataFrame:\n    "}, {"value": "postgresql", "text": "PostgreSQL", "defaultCode": "-- Write your PostgreSQL query statement below"}]}